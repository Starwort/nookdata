{"version":3,"sources":["pages/turnips/components/Chart/index.tsx","pages/turnips/page.tsx"],"names":["Chart","props","chart","chartElement","exportChart","bind","destroyChart","loadData","redraw","setChart","setChartElementRef","unloadData","updateConfig","this","updateChart","nextProps","isPure","a","b","aKeys","Object","keys","bKeys","length","index","key","shallowEqual","destroy","mimeType","onExported","undefined","console","error","export","preserveAspectRatio","data","load","flush","config","className","domProps","style","unloadBeforeLoad","bb","generate","bindto","element","unload","dataToLoad","name","value","ref","React","Component","displayName","getInstances","instance","patternNames","Pattern","FLUCTUATING","LARGE_SPIKE","DECREASING","SMALL_SPIKE","AGGREGATE","UNKNOWN","weekDays","Graph","result","t","useTranslation","theme","useTheme","xValues","day","columns","colours","names","n","pattern","column","hours","hour","push","low","min","high","max","mid","avg","toFixed","patternChance","chance","patternColours","Card","margin","CardContent","colors","type","areaSplineRange","legend","show","axis","x","tick","format","values","range","count","rotate","multiline","tooltip","culling","Grid","container","spacing","map","item","xs","sm","lg","backgroundColor","light","color","dark","CardHeader","title","titleTypographyProps","variant","fsum","filter","Turnips","foundData","getDefault","window","localStorage","turnips","clone","emptyWeek","useState","setDataImpl","confirmOpen","setConfirmOpen","dontAsk","setDontAsk","makesSense","dataMakesSense","setData","newData","toSet","deepmerge","JSON","stringify","reset","previousPattern","knownPattern","isXs","useMediaQuery","breakpoints","up","firstBuy","Tooltip","FormControlLabel","control","Checkbox","checked","onChange","event","target","label","useMemo","calculate","graph","Helmet","pageTitle","maxWidth","TextField","fullWidth","buy","am","pm","FormControl","InputLabel","id","Select","labelId","MenuItem","Button","height","onClick","turnipDontConfirm","display","justifyContent","palette","main","paddingRight","Warning","Typography","Dialog","open","DialogTitle","DialogContent","DialogActions"],"mappings":"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","file":"static/js/6.08f598ef.chunk.js","sourcesContent":["import {\n    ArrayOrString, bb, Chart as BBChart, Data, PrimitiveArray\n} from 'billboard.js';\nimport 'billboard.js/dist/billboard.css';\nimport React from 'react';\nimport { Dict } from '../../../../misc';\nimport './dark.scss';\nimport { ChartProps } from './types';\n// lifted from react-billboardjs and modified to work in typescript\n/* MIT License\n\nCopyright (c) 2017 Tony Quetano\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE. */\nfunction shallowEqual(a: Dict<any>, b: Dict<any>) {\n    const aKeys = Object.keys(a);\n    const bKeys = Object.keys(b);\n    const length = aKeys.length;\n\n    if (length !== bKeys.length) {\n        return false;\n    }\n\n    let index = -1;\n\n    while (++index < length) {\n        const key = aKeys[index];\n\n        if (key !== bKeys[index] || a[key] !== b[key]) {\n            return false;\n        }\n    }\n\n    return true;\n}\nclass Chart extends React.Component<ChartProps> {\n    static displayName = 'Chart';\n    chart: BBChart | null;\n    chartElement: HTMLDivElement | null;\n\n    static getInstances = () => {\n        return bb.instance;\n    };\n\n    constructor(props: ChartProps) {\n        super(props);\n\n        this.chart = null;\n        this.chartElement = null;\n\n        // Explicit binds instead of arrow functions for lower memory footprint.\n        this.exportChart = this.exportChart.bind(this);\n        this.destroyChart = this.destroyChart.bind(this);\n        this.loadData = this.loadData.bind(this);\n        this.redraw = this.redraw.bind(this);\n        this.setChart = this.setChart.bind(this);\n        this.setChartElementRef = this.setChartElementRef.bind(this);\n        this.unloadData = this.unloadData.bind(this);\n        this.updateConfig = this.updateConfig.bind(this);\n    }\n\n    componentDidMount() {\n        this.updateChart();\n    }\n\n    shouldComponentUpdate(nextProps: ChartProps) {\n        return !nextProps.isPure || !shallowEqual(this.props, nextProps);\n    }\n\n    componentDidUpdate() {\n        this.updateChart();\n    }\n\n    componentWillUnmount() {\n        this.destroyChart();\n    }\n\n    destroyChart() {\n        if (this.chart) {\n            this.chart.destroy();\n        }\n\n        this.chart = null;\n    }\n\n    exportChart(mimeType: string, onExported: ((dataUrl: string) => string) | undefined = undefined) {\n        if (!this.chart) {\n            // eslint-disable-next-line no-console\n            return console.error('No chart is available to export.');\n        }\n\n        this.chart.export({ mimeType, preserveAspectRatio: true }, onExported);\n    }\n\n    loadData(data: Data) {\n        if (!this.chart) {\n            // eslint-disable-next-line no-console\n            return console.error(\n                'No chart is available to which data can be loaded. It may already have been destroyed, or has never been drawn.',\n            );\n        }\n\n        this.chart.load(data as {\n            url?: string;\n            json?: [{ [key: string]: string }];\n            rows?: PrimitiveArray[];\n            columns?: PrimitiveArray[];\n            data?: Array<{ [key: string]: number }>;\n            names?: { [key: string]: string };\n            xs?: { [key: string]: string };\n            classes?: { [key: string]: string };\n            categories?: string[];\n            axes?: { [key: string]: string | string[] };\n            colors?: { [key: string]: string };\n            headers?: { [key: string]: string };\n            keys?: { [key: string]: string };\n            mimeType?: string;\n            type?: string;\n            types?: { [key: string]: string };\n            unload?: boolean | ArrayOrString;\n            done?: () => any;\n        });\n    }\n\n    redraw() {\n        if (!this.chart) {\n            // eslint-disable-next-line no-console\n            return console.error('No chart is available to draw.');\n        }\n\n        this.chart.flush();\n    }\n\n    setChart(data: Data) {\n        if (this.chart) {\n            this.loadData(data);\n        } else {\n            const {\n                className: classNameIgnored,\n                domProps: domPropsIgnored,\n                isPure: isPureIgnored,\n                style: styleIgnored,\n                unloadBeforeLoad: unloadBeforeLoadIgnored,\n                ...config\n            } = this.props;\n\n            this.chart = bb.generate({\n                bindto: this.chartElement,\n                ...config,\n            });\n        }\n    }\n\n    setChartElementRef(element: HTMLDivElement) {\n        this.chartElement = element;\n    }\n\n    unloadData(data: any) {\n        if (!this.chart) {\n            // eslint-disable-next-line no-console\n            return console.error(\n                'No chart is available from which data can be unloaded. It may already have been destroyed, or has never been drawn.',\n            );\n        }\n\n        this.chart.unload(data);\n    }\n\n    updateChart() {\n        const { data, unloadBeforeLoad } = this.props;\n        const dataToLoad = unloadBeforeLoad ? { ...data, unload: true } : data;\n\n        this.setChart(dataToLoad);\n    }\n\n    updateConfig(name: string, value: any, redraw: boolean | undefined) {\n        if (!this.chart) {\n            // eslint-disable-next-line no-console\n            return console.error(\n                'You are trying to set the config a chart that does not exist.' +\n                'Have you passed `data`?',\n            );\n        }\n\n        return this.chart.config(name, value, redraw);\n    }\n\n    render() {\n        const { className, domProps, style } = this.props;\n\n        return (\n            <div\n                className={className}\n                style={style}\n                {...domProps}\n                ref={this.setChartElementRef}\n            />\n        );\n    }\n}\nexport default Chart;\n","import {\n    Button,\n    Card,\n    CardContent,\n    CardHeader,\n    Checkbox,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogTitle,\n    FormControl,\n    FormControlLabel,\n    Grid,\n    InputLabel,\n    MenuItem,\n    Select,\n    TextField,\n    Tooltip,\n    Typography,\n    useMediaQuery,\n    useTheme\n} from \"@material-ui/core\";\nimport { Warning } from \"@material-ui/icons\";\nimport { areaSplineRange } from 'billboard.js';\nimport deepmerge from \"deepmerge\";\nimport React from \"react\";\nimport { Helmet } from \"react-helmet\";\nimport { useTranslation } from \"react-i18next\";\nimport { Centred } from '../../components';\nimport { clone, DeepPartial, Dict, fsum, getDefault, range } from \"../../misc\";\nimport { Chart } from './components';\nimport { calculate, dataMakesSense, emptyWeek, knownPattern, Pattern, patternColours, TurnipsResult, UserTurnipsData } from \"./data\";\n\nconst patternNames = {\n    [Pattern.FLUCTUATING]: \"turnips:graph.fluctuating\",\n    [Pattern.LARGE_SPIKE]: \"turnips:graph.large_spike\",\n    [Pattern.DECREASING]: \"turnips:graph.decreasing\",\n    [Pattern.SMALL_SPIKE]: \"turnips:graph.small_spike\",\n    [Pattern.AGGREGATE]: \"turnips:graph.aggregate\",\n    [Pattern.UNKNOWN]: \"Something went wrong. Sorry.\",\n}\n\nconst weekDays: ('mon' | 'tue' | 'wed' | 'thu' | 'fri' | 'sat')[] = ['mon', 'tue', 'wed', 'thu', 'fri', 'sat'];\n\nfunction Graph({ result }: { result: TurnipsResult[] }) {\n    const { t } = useTranslation(['core', 'turnips']);\n    const theme = useTheme();\n    if (result.length) {\n        let xValues = [\n            t('turnips:graph.buy'),\n            t('core:time.meridian.am.short_day', { day: t(`core:time.weekday.mon.short`) }),\n            t('core:time.meridian.pm.short_day', { day: t(`core:time.weekday.mon.short`) }),\n            t('core:time.meridian.am.short_day', { day: t(`core:time.weekday.tue.short`) }),\n            t('core:time.meridian.pm.short_day', { day: t(`core:time.weekday.tue.short`) }),\n            t('core:time.meridian.am.short_day', { day: t(`core:time.weekday.wed.short`) }),\n            t('core:time.meridian.pm.short_day', { day: t(`core:time.weekday.wed.short`) }),\n            t('core:time.meridian.am.short_day', { day: t(`core:time.weekday.thu.short`) }),\n            t('core:time.meridian.pm.short_day', { day: t(`core:time.weekday.thu.short`) }),\n            t('core:time.meridian.am.short_day', { day: t(`core:time.weekday.fri.short`) }),\n            t('core:time.meridian.pm.short_day', { day: t(`core:time.weekday.fri.short`) }),\n            t('core:time.meridian.am.short_day', { day: t(`core:time.weekday.sat.short`) }),\n            t('core:time.meridian.pm.short_day', { day: t(`core:time.weekday.sat.short`) }),\n        ];\n        let columns: [string, ...{ high: number, low: number, mid: string }[]][] = [\n        ];\n        let colours: Dict<string> = {}\n        let names: Dict<string> = {}\n        let n = 0;\n        for (let pattern of result) {\n            // for (let pattern of filteredResult) {\n            let column: [string, ...{ high: number, low: number, mid: string }[]] = [`data${n}`];\n            for (let hour of pattern.hours) {\n                column.push({ low: hour.min, high: hour.max, mid: hour.avg.toFixed(2) });\n            }\n            columns.push(column);\n            names[`data${n}`] = t(patternNames[pattern.pattern], { patternChance: (pattern.chance * 100).toFixed(2) });\n            colours[`data${n++}`] = patternColours[theme.name][pattern.pattern](pattern.chance);\n        }\n        return <>\n            <Card style={{ margin: 16 }}>\n                <CardContent>\n                    <Chart\n                        key={theme.name}  // this is very hacky but if I don't do it switching theme completely breaks the graph\n                        isPure\n                        className={`chart ${theme.name}`}\n                        data={{\n                            columns: columns as any,\n                            colors: colours,\n                            names,\n                            type: areaSplineRange(),\n                        }}\n                        legend={{\n                            // position: 'right',\n                            show: false\n                        }}\n                        axis={{\n                            x: {\n                                tick: {\n                                    format: (x: number) => (xValues[x]),\n                                    values: range(13),\n                                    count: 13,\n                                    rotate: 90,\n                                    multiline: false,\n                                    tooltip: true,\n                                    culling: false,\n                                },\n                            }\n                        }}\n                    />\n                </CardContent>\n            </Card>\n            <div style={{ margin: '0 16px' }}>\n                <Grid container spacing={2}>\n                    {[Pattern.SMALL_SPIKE, Pattern.LARGE_SPIKE, Pattern.FLUCTUATING, Pattern.DECREASING].map(pattern =>\n                        <Grid item xs={12} sm={6} lg={3}>\n                            <Card\n                                style={{\n                                    backgroundColor: theme.name === 'light' ? patternColours.light[pattern](1) : undefined,\n                                    color: theme.name === 'light' ? undefined : patternColours.dark[pattern](1),\n                                }}\n                            >\n                                <CardHeader\n                                    title={{\n                                        [Pattern.SMALL_SPIKE]: t('turnips:pattern.small_spike'),\n                                        [Pattern.LARGE_SPIKE]: t('turnips:pattern.large_spike'),\n                                        [Pattern.FLUCTUATING]: t('turnips:pattern.fluctuating'),\n                                        [Pattern.DECREASING]: t('turnips:pattern.decreasing'),\n                                        [Pattern.AGGREGATE]: 'Something went wrong',\n                                        [Pattern.UNKNOWN]: 'Something went wrong',\n                                    }[pattern]}\n                                    titleTypographyProps={{\n                                        variant: 'h6',\n                                    }}\n                                />\n                                <CardContent>\n                                    <Centred>\n                                        {(fsum(result.filter(result => result.pattern === pattern).map(result => result.chance)) * 100).toFixed(2)}%\n                                    </Centred>\n                                </CardContent>\n                            </Card>\n                        </Grid>\n                    )}\n                </Grid>\n            </div>\n        </>;\n    } else {\n        return null;\n    }\n}\n\nexport default function Turnips() {\n    const foundData = getDefault(window.localStorage.turnips, clone(emptyWeek));\n    const [data, setDataImpl] = React.useState(foundData);\n    const [confirmOpen, setConfirmOpen] = React.useState(false);\n    const [dontAsk, setDontAsk] = React.useState(false);\n    let makesSense = dataMakesSense(data);\n    function confirm() {\n        if (dontAsk) {\n            window.localStorage.turnipDontConfirm = 'true';\n        }\n        setConfirmOpen(false);\n        reset();\n    }\n    function setData(newData: DeepPartial<UserTurnipsData>) {\n        let toSet: UserTurnipsData = deepmerge<UserTurnipsData>(data, newData as Partial<UserTurnipsData>);\n        window.localStorage.turnips = JSON.stringify(toSet);\n        setDataImpl(toSet);\n    }\n    function nextWeek() {\n        if (getDefault<boolean>(window.localStorage.turnipDontConfirm, false)) {\n            reset();\n        } else {\n            setConfirmOpen(true);\n        }\n    }\n    function reset() {\n        let newData = clone(emptyWeek);\n        newData.previousPattern = knownPattern(data);\n        setData(newData);\n    }\n    const { t } = useTranslation(['core', 'turnips']);\n    const theme = useTheme();\n    const isXs = !useMediaQuery(theme.breakpoints.up('sm'));\n    const firstBuy = <Grid item xs={12} sm={6}>\n        <Centred>\n            <Tooltip\n                title={t('turnips:prices.first_buy.hover') as string}\n            >\n                <FormControlLabel\n                    control={\n                        <Checkbox\n                            checked={data.firstBuy}\n                            onChange={(event) => setData({ firstBuy: event.target.checked })}\n                            color=\"primary\"\n                        />\n                    }\n                    label={t('turnips:prices.first_buy.checkbox')}\n                />\n            </Tooltip>\n        </Centred>\n    </Grid>;\n    const result = React.useMemo(\n        () => dataMakesSense(data) ? calculate(data) : [],\n        [data]\n    );\n    if (!result.length) {\n        makesSense = false;\n    }\n    let graph = <Graph result={result} />\n    return <>\n        <Helmet>\n            <title>{t('core:title.browser.page', { pageTitle: t('core:pages.turnips') })}</title>\n        </Helmet>\n        <div style={{ maxWidth: 800, margin: 'auto' }}>\n            <Card style={{ margin: 16 }}>\n                <CardHeader title={t('turnips:prices.title')} />\n                <CardContent>\n                    <Grid container spacing={1}>\n                        {isXs && firstBuy}\n                        <Grid item xs={12} sm={6}>\n                            <TextField type=\"number\" fullWidth value={data.buy ?? ''} onChange={(event) => setData({ buy: event.target.value ? +event.target.value : null })} label={t('turnips:prices.buy')} />\n                        </Grid>\n                        {!isXs && firstBuy}\n                        {weekDays.map((day) => (\n                            <>\n                                <Grid item xs={12} sm={6}>\n                                    <TextField type=\"number\" fullWidth value={data[day].am ?? ''} onChange={(event) => setData({ [day]: { am: event.target.value ? +event.target.value : null } })} label={t('core:time.meridian.am.long_day', { day: t(`core:time.weekday.${day}.long`) })} />\n                                </Grid>\n                                <Grid item xs={12} sm={6}>\n                                    <TextField type=\"number\" fullWidth value={data[day].pm ?? ''} onChange={(event) => setData({ [day]: { pm: event.target.value ? +event.target.value : null } })} label={t('core:time.meridian.pm.long_day', { day: t(`core:time.weekday.${day}.long`) })} />\n                                </Grid>\n                            </>\n                        ))}\n                        <Grid item xs={12} sm={6}>\n                            <FormControl fullWidth>\n                                <InputLabel id=\"comp-label\">{t('turnips:pattern.label')}</InputLabel>\n                                <Select\n                                    value={data.previousPattern}\n                                    onChange={(event) => setData(\n                                        { previousPattern: event.target.value as Pattern }\n                                    )}\n                                    labelId='pattern-label'\n                                    fullWidth\n                                >\n                                    <MenuItem value={Pattern.SMALL_SPIKE}>{t('turnips:pattern.small_spike')}</MenuItem>\n                                    <MenuItem value={Pattern.LARGE_SPIKE}>{t('turnips:pattern.large_spike')}</MenuItem>\n                                    <MenuItem value={Pattern.FLUCTUATING}>{t('turnips:pattern.fluctuating')}</MenuItem>\n                                    <MenuItem value={Pattern.DECREASING}>{t('turnips:pattern.decreasing')}</MenuItem>\n                                    <MenuItem value={Pattern.UNKNOWN}>{t('turnips:pattern.unknown')}</MenuItem>\n                                </Select>\n                            </FormControl>\n                        </Grid>\n                        <Grid item xs={12} sm={6}>\n                            <Button style={{ height: '100%' }} fullWidth variant=\"contained\" color=\"primary\" onClick={nextWeek}>{t('turnips:ui.start_next')}</Button>\n                        </Grid>\n                    </Grid>\n                    {makesSense || <>\n                        <br />\n                        <Centred>\n                            <div\n                                style={{\n                                    display: 'inline-flex',\n                                    justifyContent: 'center',\n                                    height: '100%',\n                                    color: theme.palette.error.main,\n                                    paddingRight: 8\n                                }}\n                            >\n                                <Warning />\n                            </div>\n                            <Typography color=\"error\">{t('turnips:ui.bad_data')}</Typography>\n                        </Centred>\n                    </>\n                    }\n                </CardContent>\n            </Card>\n            {graph}\n        </div>\n        <Dialog open={confirmOpen}>\n            <DialogTitle>{t('turnips:ui.reset_dialogue.title')}</DialogTitle>\n            <DialogContent>\n                {t('turnips:ui.reset_dialogue.text')}\n                <br />\n                <FormControlLabel\n                    control={\n                        <Checkbox\n                            checked={dontAsk}\n                            onChange={(event) => setDontAsk(event.target.checked)}\n                            color=\"primary\"\n                        />\n                    }\n                    label={t('core:ui.dont_ask')}\n                />\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={() => setConfirmOpen(false)}>\n                    {t('core:ui.cancel')}\n                </Button>\n                <Button onClick={confirm}>\n                    {t('core:ui.confirm')}\n                </Button>\n            </DialogActions>\n        </Dialog>\n    </>;\n}"],"sourceRoot":""}